# CoS Command System QA Report -- 2026-02-20

## Summary

Full audit of 9 commands in `/Users/vahid/code/CoS/.claude/commands/` plus 6 old commands in `/Users/vahid/code/CoS/commands/`. Cross-referenced against CLAUDE.md, source-of-record.md, goals.yaml, my-tasks.yaml, schedules.yaml.

**Result: 11 issues found, 8 fixed, 3 advisory (no fix needed).**

Validation script: 112 passed, 0 failed, 9 warnings (all warnings are advisory).

---

## Issues Found & Fixed

### 1. Truncated Notion DB IDs in review-queue.md
- **Severity:** Medium
- **Detail:** `review-queue.md` referenced Tasks DB as `bfaf4e0f` and Opportunities DB as `de289591` instead of full UUIDs. Other commands use full IDs consistently.
- **Fix:** Expanded to full UUIDs (`bfaf4e0f-1352-40cb-b39e-e441b75c1d96`, `de289591-f32a-483d-a51e-6bc158f4173e`).
- **Status:** FIXED

### 2. retro.md missing local save path
- **Severity:** Medium
- **Detail:** SOR defines retro reports go to `CoS/assets/retros/`. The command only said "saved locally" without specifying the path.
- **Fix:** Added explicit path `assets/retros/retro-YYYY-MM-DD.md`.
- **Status:** FIXED

### 3. enrich.md SOR violation -- Clay not referenced as SOR
- **Severity:** High
- **Detail:** `enrich.md` treated local `contacts/` files as the primary data store. Per `source-of-record.md`, Clay.earth is the SOR for contacts; local files are interaction history caches only.
- **Fix:** Added SOR section at top of command clarifying Clay is primary, local files are cache.
- **Status:** FIXED

### 4. debrief.md SOR violation -- contact updates to local files only
- **Severity:** High
- **Detail:** Step 6 (Update Contact File) wrote only to local `contacts/` directory. Should write to Clay first per SOR.
- **Fix:** Updated Step 6 to reference Clay (`mcp__claude_ai_Clay_earth__updateContact`/`createContact`) as primary, local files as cache.
- **Status:** FIXED

### 5. the-mirror.md contained emoji characters
- **Severity:** Low
- **Detail:** Output template used emoji (green circle, yellow circle, mirror emoji). CLAUDE.md and global instructions explicitly prohibit emojis in output.
- **Fix:** Replaced with text markers: `[+]`, `[~]`, `[mirror]`.
- **Status:** FIXED

### 6. review-queue.md hardcoded Telegram bot token reference
- **Severity:** Medium (security)
- **Detail:** Step 8 referenced bot token URL pattern inline. Tokens should come from config, not be hardcoded in command text.
- **Fix:** Replaced with reference to CLAUDE.md config.
- **Status:** FIXED

### 7. Missing Telegram send guardrails (3 commands)
- **Severity:** High
- **Detail:** `retro.md`, `the-mirror.md`, and `review-queue.md` all send Telegram messages but had no explicit "wait for approval" guardrail. This violates the core message-sending guardrail rule.
- **Fix:** Added approval requirement to all three commands.
- **Status:** FIXED

### 8. Old commands in /commands/ are stale (ADVISORY)
- **Severity:** Low
- **Detail:** 6 old commands in `/Users/vahid/code/CoS/commands/` still have `{{YOUR_NAME}}` placeholders and `~/.claude/` paths. These are the pre-migration originals.
- **Recommendation:** Delete or archive. Active commands are in `.claude/commands/`.
- **Status:** ADVISORY -- not fixed (would violate "don't edit existing files" rule; flagging for cleanup)

---

## Structural Validation

| Command | Description | Arguments | Steps | Output Format | Result |
|---------|------------|-----------|-------|---------------|--------|
| gm.md | Yes | N/A | 7 steps | Yes | PASS |
| triage.md | Yes | Yes (3) | 7 steps | Yes | PASS |
| meeting-prep.md | Yes | Yes (3) | 8 steps | Yes | PASS |
| debrief.md | Yes | Yes (3) | 8 steps | Yes | PASS |
| my-tasks.md | Yes | Yes (5) | 5 subcommands | Yes | PASS |
| retro.md | Yes | Yes (2) | 7 steps | Yes | PASS |
| the-mirror.md | Yes | Yes (3) | 6 steps | Yes | PASS |
| enrich.md | Yes | Yes (3) | 3 subcommands | Yes | PASS |
| review-queue.md | Yes | Yes (2) | 8 steps | Yes | PASS |

---

## Notion DB ID Audit

All IDs in commands match canonical values from CLAUDE.md:

| DB | Canonical ID | Referenced In |
|----|-------------|---------------|
| Companies | `5fee82ee-a0e1-41f5-aaca-308e03580182` | debrief.md |
| People | `11d6ce8b-a1af-455a-b9c5-d50d1aec5796` | debrief.md |
| PE Firms | `fce2fe71-0d9d-46e1-a23a-d9dc99c056df` | (not directly referenced in commands) |
| Opportunities | `de289591-f32a-483d-a51e-6bc158f4173e` | debrief.md, retro.md, review-queue.md |
| Tasks | `bfaf4e0f-1352-40cb-b39e-e441b75c1d96` | debrief.md, my-tasks.md, retro.md, review-queue.md |
| Vahid (Assignee) | `622468d8-a961-4066-b9fe-65c0970a7852` | debrief.md, my-tasks.md, retro.md |

No unknown IDs found. No typos detected.

---

## Notion Property Names (per DB)

### Tasks DB
- **Name** (title)
- **Client**: "fCPO"
- **Assignee**: Vahid's person ID
- **Priority**: 1=Urgent, 2=High, 3=Medium, 4=Low
- **Due date**: date
- **Status**: `Not started`, `WIP`, `Done`, `Needs Review`, `Blocked`, `Waiting on Vahid`

Consistent across: debrief.md, my-tasks.md, retro.md, review-queue.md.

### Opportunities DB
Referenced for pipeline/deal tasks in debrief.md, retro.md, review-queue.md. No property writes specified -- used for reads/status checks.

### Companies DB / People DB
Referenced in debrief.md for adding notes. No specific property writes beyond "add notes."

No inconsistencies found in property names across commands.

---

## Cross-Command Flow

| From | References | Exists? |
|------|-----------|---------|
| gm.md | /meeting-prep | Yes |
| schedules.yaml | /gm, /triage, /my-tasks, /meeting-prep, /retro, /the-mirror, /review-queue, /enrich | All exist |
| retro.md | /review-queue (implied via "Queue Review Items") | Yes |

No circular dependencies. No broken references.

---

## SOR Compliance

| Command | Reads From | Writes To | SOR Compliant? |
|---------|-----------|-----------|---------------|
| gm.md | Calendar, my-tasks.yaml, goals.yaml, Gmail | my-tasks.yaml (stale fix) | Yes |
| triage.md | Gmail, Slack, WhatsApp | Drafts (Gmail) | Yes |
| meeting-prep.md | Calendar, Clay, Granola, Fellow, Gmail | Fellow (talking points), local prep file | Yes |
| debrief.md | Granola, Fellow | Notion Tasks, Clay, my-tasks.yaml | Yes (after fix) |
| my-tasks.md | my-tasks.yaml, Notion Tasks | my-tasks.yaml, Notion Tasks | Yes |
| retro.md | my-tasks.yaml, goals.yaml, Calendar, Notion | goals.yaml, Notion Tasks, local retro file | Yes (after fix) |
| the-mirror.md | Granola, Fellow | growth-traits.yaml, local mirror file | Yes |
| enrich.md | Gmail, Slack, WhatsApp, Calendar | Clay, local contacts cache | Yes (after fix) |
| review-queue.md | Notion Tasks, local assets, Gmail, Notion Pipeline | local report, Telegram | Yes |

---

## Business Rule Compliance

- Triage tiers in triage.md match CLAUDE.md definitions (Tier 1/2/3 with correct criteria). PASS.
- Contact tier cadences in enrich.md match CLAUDE.md (T1=14d, T2=30d, T3=60d). PASS.
- CRM architecture: no command writes workflow fields to entity DBs. PASS.
- No command writes `Customer Status` (deleted property). PASS.
- Message-sending guardrail present in all commands that send messages. PASS (after fixes).
- my-tasks.md correctly identifies Notion as SOR, YAML as backup. PASS.

---

## Validation Script

Updated at `/Users/vahid/code/CoS/tests/validate-commands.sh` with new checks:
- Notion DB ID completeness (no truncated IDs)
- Notion DB ID correctness (all match canonical)
- SOR compliance (Clay referenced in enrich/debrief, retro save path)
- No emojis in command files
- Telegram send guardrails
- Old commands staleness detection

**Current results: 112 passed, 0 failed, 9 warnings.**
